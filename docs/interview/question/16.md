## :question:谈谈你对 TCP 三次握手和四次挥手的理解

### 三次握手

其实就是指建立 TCP 链接时，需要客户端和服务器共发送三个包。进行三次握手的主要作用就是为了确认双方的接受能力和发送能力是否正常，指定自己的初始化序列号为
后面的可靠性传输作准备。实质上就是链接服务器指定端口，建立 TCP 链接，并同步链接双方的序列号和确认号，交换 TCP 窗口大小信息。

刚开始的时候客户端处于 Closed 状态，服务端处于 Listen 状态。

开始进行三次握手：

第一次握手：客户端给服务端发送一个 SYN 报文，并指明客户端的初始化序列号 ISN©。此时客户端处于 SYN_SEND 状态。

首部的同步位 SYN = 1，初始化序列号 seq = x，SYN = 1 的报文不能携带收据，但要消耗掉一个序号。

第二次握手：服务器收到客户端的 SYN 报文之后，会以自己的 SYN 报文作为应答，并且指定自己初始化序列号 ISN(s)。
同时会把客户端的 ISN + 1 作为 ACK 的值，表示自己已经收到客户端的 SYN，此时服务器处于 SYN_REVD 的状态。

在确认报文中，SYN = 1，ACK = 1，确认号 ack = x + 1，初始化序列号 seq = y。

第三次握手：客户端接收到 SYN 报文之后，会向客户端发送一个 ACK 报文，也是把服务器的 ISN + 1 作为 ACK 的值，表示已经收到服务器 SYN 报文，
此时客户端处于 ESTABLISHED 状态。服务器收到 ACK 报文之后，也处于 ESTABLISHED 状态，此时，双方已建立起了连接。

确认报文段 ACK=1，确认号 ack = y + 1，序号 seq = x + 1（初始为 seq = x，第二个报文段所以要 + 1），ACK 报文段可以携带数据，
不携带数据则不消耗序号。
