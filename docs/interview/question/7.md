## :question:ES5/ES6 çš„ç»§æ‰¿é™¤äº†å†™æ³•ä»¥å¤–è¿˜æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

## ç»§æ‰¿å·®å¼‚ï¼š

- ES5 çš„ç»§æ‰¿ï¼Œå®è´¨æ˜¯å…ˆåˆ›é€ å­ç±»çš„å®ä¾‹å¯¹è±¡ `this`ï¼Œç„¶åå†å°†çˆ¶ç±»çš„æ–¹æ³•æ·»åŠ åˆ° `this` ä¸Šé¢ï¼ˆ`Parent.apply(this)`ï¼‰ã€‚ES6 çš„ç»§æ‰¿æœºåˆ¶å®Œå…¨ä¸åŒï¼Œå®è´¨æ˜¯å…ˆå°†çˆ¶ç±»å®ä¾‹å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼ŒåŠ åˆ° `this` ä¸Šé¢ï¼ˆæ‰€ä»¥å¿…é¡»å…ˆè°ƒç”¨ `super` æ–¹æ³•ï¼‰ï¼Œç„¶åå†ç”¨å­ç±»çš„æ„é€ å‡½æ•°ä¿®æ”¹ `thisã€‚`
- ES5 å®ç°ä¹‹ä¸­ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡éƒ½æœ‰`__proto__`å±æ€§ï¼ŒæŒ‡å‘å¯¹åº”çš„æ„é€ å‡½æ•°çš„ `prototype` å±æ€§ã€‚
  Class ä½œä¸ºæ„é€ å‡½æ•°çš„è¯­æ³•ç³–ï¼ŒåŒæ—¶æœ‰ `prototype` å±æ€§å’Œ `__proto__` å±æ€§ï¼Œå› æ­¤åŒæ—¶å­˜åœ¨ä¸¤æ¡ç»§æ‰¿é“¾ã€‚

  1. å­ç±»çš„ `__proto__` å±æ€§ï¼Œè¡¨ç¤ºæ„é€ å‡½æ•°çš„ç»§æ‰¿ï¼Œæ€»æ˜¯æŒ‡å‘çˆ¶ç±»ã€‚
  2. å­ç±» `prototype` å±æ€§çš„ `__proto__` å±æ€§ï¼Œè¡¨ç¤ºæ–¹æ³•çš„ç»§æ‰¿ï¼Œæ€»æ˜¯æŒ‡å‘çˆ¶ç±»çš„ `prototype` å±æ€§ã€‚

  ```js
  class A {}

  class B extends A {}

  B.__proto__ === A; // true
  B.prototype.__proto__ === A.prototype; // true
  ```

  [ä¸ºä»€ä¹ˆæ˜¯è¿™æ ·å®ç°çš„](http://es6.ruanyifeng.com/#docs/class-extends#%E7%B1%BB%E7%9A%84-prototype-%E5%B1%9E%E6%80%A7%E5%92%8C__proto__%E5%B1%9E%E6%80%A7)

é™¤ç»§æ‰¿å¤–çš„ä¸€äº›å·®å¼‚ï¼Œæˆ‘ä»¬çš„ ğŸŒ°

```js
// es5
function AnimalEs5(name) {
  this.name = name;
}

AnimalEs5.prototype.getName = function() {
  return this.name;
};

// es6
class AnimalEs6 {
  constructor(name) {
    this.name = name;
  }

  static getType() {
    return "AnimalEs6";
  }

  getName() {
    return this.name;
  }
}
```

- `class` å£°æ˜ä¸ä¼šå˜é‡æå‡

```js
new Foo(); // ReferenceError: Foo is not defined

class Foo {
```

ä¸Šé¢ä»£ç ä¸­ï¼ŒFoo ç±»ä½¿ç”¨åœ¨å‰ï¼Œå®šä¹‰åœ¨åï¼Œè¿™æ ·ä¼šæŠ¥é”™ï¼Œå› ä¸º ES6 ä¸ä¼šæŠŠç±»çš„å£°æ˜æå‡åˆ°ä»£ç å¤´éƒ¨ã€‚è¿™ç§è§„å®šçš„åŸå› ä¹Ÿä¸ç»§æ‰¿æœ‰å…³ï¼Œå¿…é¡»ä¿è¯å­ç±»åœ¨çˆ¶ç±»ä¹‹åå®šä¹‰ã€‚

- `class` å¿…é¡»ä½¿ç”¨ `new` è°ƒç”¨ï¼Œå¦åˆ™ä¼šæŠ¥é”™

```js
// es5 è°ƒç”¨
AnimalEs5(); // it's ok

// es6 è°ƒç”¨
AnimalEs6(); // Class constructor AnimalEs6 cannot be invoked without 'new'
```

- `class` çš„å†…éƒ¨ï¼Œé»˜è®¤å°±æ˜¯ä¸¥æ ¼æ¨¡å¼

> ç±»å’Œæ¨¡å—çš„å†…éƒ¨ï¼Œé»˜è®¤å°±æ˜¯ä¸¥æ ¼æ¨¡å¼ï¼Œæ‰€ä»¥ä¸éœ€è¦ä½¿ç”¨ use strict æŒ‡å®šè¿è¡Œæ¨¡å¼ã€‚åªè¦ä½ çš„ä»£ç å†™åœ¨ç±»æˆ–æ¨¡å—ä¹‹ä¸­ï¼Œå°±åªæœ‰ä¸¥æ ¼æ¨¡å¼å¯ç”¨ã€‚è€ƒè™‘åˆ°æœªæ¥æ‰€æœ‰çš„ä»£ç ï¼Œå…¶å®éƒ½æ˜¯è¿è¡Œåœ¨æ¨¡å—ä¹‹ä¸­ï¼Œæ‰€ä»¥ ES6 å®é™…ä¸ŠæŠŠæ•´ä¸ªè¯­è¨€å‡çº§åˆ°äº†ä¸¥æ ¼æ¨¡å¼ã€‚

```js
// å¼•ç”¨ä¸€ä¸ªæœªå£°æ˜çš„å˜é‡
function Bar() {
  baz = 42; // it's ok
}
const bar = new Bar();

class Foo {
  constructor() {
    fol = 42; // ReferenceError: fol is not defined
  }
}
const foo = new Foo();
```

- `class` å†…éƒ¨æ‰€æœ‰å®šä¹‰çš„æ–¹æ³•éƒ½æ˜¯ä¸å¯æšä¸¾çš„ï¼ˆnon-enumerableï¼‰

```js
// es5 è°ƒç”¨
Object.keys(AnimalEs5.prototype); // [ 'getName' ]
Object.getOwnPropertyNames(AnimalEs5.prototype); // [ 'constructor', 'getName' ]

// es6è°ƒç”¨
Object.keys(AnimalEs6.prototype); // []
Object.getOwnPropertyNames(AnimalEs6.prototype); // [ 'constructor', 'getName' ]
```

- `class` å†…å£°æ˜çš„æ‰€æœ‰çš„æ–¹æ³•ï¼ˆåŒ…æ‹¬é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•ï¼‰éƒ½æ²¡æœ‰åŸå‹å¯¹è±¡ prototype æ‰€ä»¥ä¹Ÿæ²¡æœ‰ [[construct]],ä¸èƒ½ç”¨ `new` æ¥è°ƒç”¨

```js
const dog = new AnimalEs5();
const dogName = new dog.getName(); // it's ok

const es6Dog = new AnimalEs6();
const es6DogName = new es6Dog.getName(); // TypeError: es6Dog.getName is not a constructor
```

- `class` å†…éƒ¨ç±»åæ— æ³•è¢«é‡å†™

```js
class AnimalEs6 {
  constructor(name) {
    this.name = name;
    // AnimalEs6 = "AnimalEs6Change"; // TypeError: Assignment to constant variable.
    // asd = "dad"; // ReferenceError: asd is not defined ä¸¥æ ¼æ¨¡å¼
  }

  static getType() {
    return "AnimalEs6";
  }

  getName() {
    return this.name;
  }
}
```

å¦‚æœå¤§å®¶æœ‰çœ‹ testğŸŒ° çš„æ³¨æ„æŠ¥é”™å“¦ã€‚
